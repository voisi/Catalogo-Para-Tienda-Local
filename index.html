<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gourmet Market | Tienda en 23 y 18 Vedado </title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .product-card { width: 260px; transition: all 0.3s ease; flex-shrink: 0; }
        @media (max-width: 640px) {
            .product-card { width: 210px; }
        }
        /* Ajuste de opacidad para que no se vea tan borroso el producto agotado */
        .producto-agotado { filter: grayscale(0.8) opacity(0.7); }
        .bg-blur { backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); }
        .category-btn.active { background-color: #111827; color: white; border-color: #111827; }
        @keyframes pulse-soft { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }
        .pulse { animation: pulse-soft 2s infinite; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen pb-24 text-gray-900">

    <div class="bg-amber-50 border-b border-amber-100 py-3 px-4">
        <div class="max-w-[1400px] mx-auto flex items-center justify-center gap-3 text-amber-800">
            <i class="fas fa-sync-alt text-[10px] animate-spin"></i>
            <p class="text-[10px] font-black uppercase tracking-wider text-center">
                Inventario actualizado hoy a las 8:00 AM â€¢ Solo venta en local 23 y 18
            </p>
        </div>
    </div>

    <header class="bg-white/90 bg-blur sticky top-0 z-50 border-b border-gray-100 shadow-sm">
        <div class="max-w-[1400px] mx-auto px-4 py-4 space-y-4">
            <div class="flex justify-between items-center">
                <div>
                    <h1 class="text-xl font-black tracking-tighter uppercase italic leading-none">Gourmet<span class="text-green-600">Market</span></h1>
                    <p class="text-[9px] font-bold text-gray-400 mt-1 uppercase tracking-tighter">Vedado, La Habana</p>
                </div>
                <a href="https://www.google.com/maps/search/?api=1&query=23+y+18+Vedado+La+Habana" target="_blank" class="bg-blue-600 text-white px-4 py-2.5 rounded-2xl text-[10px] font-black flex items-center gap-2 shadow-lg shadow-blue-100">
                    <i class="fas fa-location-arrow"></i> UBICACIÃ“N
                </a>
            </div>
            
            <div class="relative w-full max-w-2xl mx-auto">
                <i class="fas fa-search absolute left-4 top-1/2 -translate-y-1/2 text-gray-400"></i>
                <input type="text" id="busqueda" oninput="ejecutarFiltros()" placeholder="Busca lo que entrÃ³ hoy..." 
                    class="w-full bg-gray-100 border-none rounded-2xl py-3.5 pl-12 pr-4 text-sm focus:ring-2 focus:ring-green-500 transition shadow-inner">
            </div>
        </div>

        <div class="bg-white border-t border-gray-50 overflow-x-auto no-scrollbar">
            <div id="categorias-nav" class="max-w-[1400px] mx-auto px-4 py-3 flex gap-2">
                <button onclick="seleccionarCategoria('Todos')" class="category-btn active border px-5 py-2 rounded-full text-[11px] font-bold whitespace-nowrap transition">Todos</button>
                <button onclick="seleccionarCategoria('ProteÃ­nas')" class="category-btn border px-5 py-2 rounded-full text-[11px] font-bold whitespace-nowrap transition text-gray-500">ProteÃ­nas</button>
                <button onclick="seleccionarCategoria('Vegetales')" class="category-btn border px-5 py-2 rounded-full text-[11px] font-bold whitespace-nowrap transition text-gray-500">Vegetales</button>
                <button onclick="seleccionarCategoria('LÃ¡cteos')" class="category-btn border px-5 py-2 rounded-full text-[11px] font-bold whitespace-nowrap transition text-gray-500">LÃ¡cteos</button>
                <button onclick="seleccionarCategoria('Frutas')" class="category-btn border px-5 py-2 rounded-full text-[11px] font-bold whitespace-nowrap transition text-gray-500">Frutas</button>
                <button onclick="seleccionarCategoria('Abarrotes')" class="category-btn border px-5 py-2 rounded-full text-[11px] font-bold whitespace-nowrap transition text-gray-500">Abarrotes</button>
            </div>
        </div>
    </header>

    <main class="max-w-[1400px] mx-auto px-4 py-8">
        
        <section id="section-nuevo" class="mb-14">
            <h2 class="text-[10px] font-black text-green-600 uppercase tracking-[0.3em] mb-6 flex items-center gap-3">
                <span class="h-4 w-1 bg-green-500 rounded-full"></span> LlegÃ³ hoy al local
            </h2>
            <div id="container-nuevo" class="flex gap-6 overflow-x-auto pb-4 no-scrollbar"></div>
        </section>

        <section id="section-agotado" class="mb-14">
            <h2 class="text-[10px] font-black text-red-500 uppercase tracking-[0.3em] mb-6 flex items-center gap-3">
                <span class="h-4 w-1 bg-red-500 rounded-full"></span> Sin existencias hoy
            </h2>
            <div id="container-agotado" class="flex gap-6 overflow-x-auto pb-4 no-scrollbar"></div>
        </section>

        <hr id="separador" class="mb-12 border-gray-100">

        <section id="section-principal">
            <h2 id="txt-principal" class="text-[10px] font-black text-gray-400 uppercase tracking-[0.3em] mb-8 flex items-center gap-3">
                <span class="h-px w-12 bg-gray-200"></span> Inventario disponible
            </h2>
            <div id="container-principal" class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-3 md:gap-6"></div>
        </section>

        <div id="no-results" class="hidden py-20 text-center text-gray-400 italic">No hay productos disponibles bajo estos criterios.</div>
    </main>

    <script>
        const WHATSAPP_NUMBER = "5300000000"; 
        let productos = [];
        let categoriaActual = "Todos";

        const normalizar = (t) => t.normalize("NFD").replace(/[\u0300-\u036f]/g, "").toLowerCase();

        async function loadData() {
            try {
                const response = await fetch('productos.json');
                productos = await response.json();
                ejecutarFiltros();
            } catch (e) { console.error("Error", e); }
        }

        function createCard(p, isAgotado = false) {
            const esCritico = p.stock > 0 && p.stock <= 10;
            const entroHoy = p.entrada === "hoy";
            const stockColor = esCritico ? 'bg-orange-50 text-orange-700' : 'bg-gray-50 text-gray-600';
            
            return `
                <div class="product-card bg-white rounded-[1.5rem] md:rounded-[2.5rem] border border-gray-100 overflow-hidden flex flex-col ${isAgotado ? 'producto-agotado shadow-sm' : 'shadow-sm hover:shadow-xl'}">
                    <div class="relative h-32 md:h-44 overflow-hidden">
                        <img src="${p.img}" class="w-full h-full object-cover">
                        ${entroHoy && !isAgotado ? `<span class="absolute top-2 right-2 md:top-3 md:right-3 bg-green-500 text-white text-[7px] md:text-[8px] font-black px-2 py-1 rounded-lg uppercase tracking-widest shadow-lg">EntrÃ³ Hoy</span>` : ''}
                        ${esCritico ? `<span class="absolute top-2 left-2 md:top-3 md:left-3 bg-orange-500 text-white text-[7px] md:text-[8px] font-black px-2 py-1 rounded-lg uppercase pulse">Â¡Quedan ${p.stock}!</span>` : ''}
                    </div>
                    <div class="p-3 md:p-4 flex flex-col flex-grow">
                        <h3 class="font-bold text-gray-900 text-[11px] md:text-sm mb-0.5 md:mb-1 truncate">${p.nombre}</h3>
                        <p class="text-[9px] md:text-[10px] text-gray-400 font-bold mb-2 md:mb-3 uppercase">${p.g}G | ${p.lb}LB</p>
                        <div class="flex items-center justify-between mb-3 md:mb-4 ${stockColor} px-2 md:px-3 py-1 md:py-1.5 rounded-xl border border-black/5">
                            <span class="text-[7px] md:text-[8px] font-black uppercase">Stock</span>
                            <span class="text-[10px] md:text-xs font-black">${p.stock} un.</span>
                        </div>
                        <div class="mt-auto">
                            <div class="text-center mb-2 md:mb-3 font-black text-gray-900 text-base md:text-lg">$${p.precio.toFixed(2)}</div>
                            ${isAgotado ? 
                                `<div class="w-full py-2 md:py-3 bg-gray-200/50 text-gray-600 rounded-xl md:rounded-2xl text-[9px] md:text-[10px] font-black uppercase text-center italic border border-gray-300">Agotado</div>` :
                                esCritico ? 
                                `<button onclick="consultar('${p.nombre}')" class="w-full py-2 md:py-3 bg-orange-500 text-white rounded-xl md:rounded-2xl text-[8px] md:text-[10px] font-black uppercase tracking-widest hover:bg-orange-600 transition flex items-center justify-center gap-2">Preguntar <i class="fab fa-whatsapp"></i></button>` :
                                `<div class="w-full py-2 md:py-3 bg-green-50 text-green-700 rounded-xl md:rounded-2xl text-[8px] md:text-[10px] font-black uppercase tracking-widest text-center border border-green-100">En existencia</div>`
                            }
                        </div>
                    </div>
                </div>`;
        }

        function consultar(nombre) {
            const msg = `Hola! ðŸ‘‹ Veo que quedan pocos de *${nombre}* en la tienda de 23 y 18. Â¿AÃºn tienen disponibles?`;
            window.open(`https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(msg)}`);
        }

        function seleccionarCategoria(cat) {
            categoriaActual = cat;
            document.querySelectorAll('.category-btn').forEach(btn => btn.classList.toggle('active', btn.innerText === cat));
            ejecutarFiltros();
        }

        function ejecutarFiltros() {
            const query = normalizar(document.getElementById('busqueda').value);
            const esVistaTodos = (categoriaActual === "Todos" && query === "");

            if (esVistaTodos) {
                renderSection('container-nuevo', 'section-nuevo', productos.filter(p => p.entrada === 'hoy' && p.stock > 0));
                renderSection('container-agotado', 'section-agotado', productos.filter(p => p.stock === 0));
                renderSection('container-principal', 'section-principal', productos.filter(p => p.entrada !== 'hoy' && p.stock > 0));
                document.getElementById('separador').classList.remove('hidden');
                document.getElementById('txt-principal').classList.remove('hidden');
            } else {
                document.getElementById('section-nuevo').classList.add('hidden');
                document.getElementById('section-agotado').classList.add('hidden');
                document.getElementById('separador').classList.add('hidden');
                document.getElementById('txt-principal').classList.add('hidden');

                const filtrados = productos.filter(p => {
                    const matchQuery = normalizar(p.nombre).includes(query);
                    const matchCat = (categoriaActual === "Todos" || p.cat === categoriaActual);
                    return matchQuery && matchCat && p.stock > 0;
                });
                renderSection('container-principal', 'section-principal', filtrados);
                document.getElementById('no-results').classList.toggle('hidden', filtrados.length > 0);
            }
        }

        function renderSection(containerId, sectionId, items) {
            const container = document.getElementById(containerId);
            const section = document.getElementById(sectionId);
            if (items.length === 0) {
                section.classList.add('hidden');
            } else {
                section.classList.remove('hidden');
                container.innerHTML = items.map(p => {
                    let card = createCard(p, p.stock === 0);
                    return containerId === 'container-principal' ? card.replace('product-card', 'w-full') : card;
                }).join('');
            }
        }

        loadData();
    </script>
</body>
</html>
